FROM node:18-alpine

# Set working directory
WORKDIR /app

# Install dependencies
COPY package*.json ./
COPY yarn.lock* ./

# Install all dependencies (including dev dependencies)
RUN if [ -f yarn.lock ]; then yarn install; \
    else npm install; fi

# Copy source code
COPY . .

# Create .env.local from template if it doesn't exist
RUN if [ ! -f .env.local ]; then cp env.template .env.local; fi

# Expose port
EXPOSE 3000

# Start development server with hot reload
CMD ["npm", "run", "dev"]
